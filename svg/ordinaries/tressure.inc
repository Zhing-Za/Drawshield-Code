<?php /* Copyright 2010-2021 Karl Wilcox, Mattias Basaglia

This file is part of the DrawShield.net heraldry image creation program

    DrawShield is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

     DrawShield is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with  DrawShield.  If not, see https://www.gnu.org/licenses/.
 */


require_once("shield_shape_utils.inc");

$shape = ShieldShape::from_layout($layout);

if ( existModifierWithKeyterm($node,'flory-counter-flory')) {
    $messages->addMessage('licence','Tressure flory - http://commons.wikimedia.org/wiki/User:Balmung0731');
    if ( $layout->size->height >= 1000 )
            $ordinary['body'] = '<g  >
          <path d="m76.1, 83.26   c0,0 -10.89,-25 -1.485,-34.27 9.415,-9.263 20.1,4.196 20.1,4.196 0,0 6.643,-36.18 -21.24,-30.92 -27.88,5.272 -14.66,39.89 -14.66,39.89 0,0 -27.07,-32.29 -46.41,-27.62 -1.575,21.88 30.73,47.01 30.73,47.01 0,0 -32.75,-9.834 -33.73,21.44 -0.976,31.28 30.52,19.13 30.52,19.13 0,0 -13.49,-9.918 -6.453,-21.48 7.025,-11.57 31.34,-3.53 31.34,-3.53   "  />
          <path d="m106.4, 142.4   c0,0 61.39,44.05 23.4,-10.82   l-23.15,0 -0.2616,10.82   z "  />
          <path d="m492.2, 130.4   c0,0 -10.87,25.02 -23.74,23.72 -12.88,-1.308 -10.2,-18.57 -10.2,-18.57 0,0 -30.48,18.59 -8.347,37.02 22.14,18.44 38.42,-14.71 38.42,-14.71 0,0 -5.5,42.52 10.61,54.67 16.81,-13.15 13.7,-55.09 13.7,-55.09 0,0 14.45,32.22 37.66,12.41 23.22,-19.81 -6.29,-36.58 -6.29,-36.58 0,0 1.715,17.13 -11.26,19.2 -12.97,2.09 -23.17,-22.3 -23.17,-22.3   "  />
          <path d="m938.6, 93.79   c0,0 23.49,-12.35 32.73,-2.908 9.239,9.453 -3.22,21.13 -3.22,21.13 0,0 34.91,5.494 28.77,-23.35 -6.152,-28.87 -38.76,-13.71 -38.76,-13.71 0,0 29.85,-29.5 24.6,-49.52 -20.99,-0.7762 -43.79,33.92 -43.79,33.92 0,0 8.116,-34.55 -21.86,-34.32 -29.99,0.2222 -17.1,32.62 -17.1,32.62 0,0 8.961,-14.46 20.32,-7.58 11.36,6.868 4.62,32.54 4.62,32.54   "  />
          <path d="m896.1, 492   c0,0 -23.43,-12.46 -21.61,-25.82 1.832,-13.37 18.23,-9.803 18.23,-9.803 0,0 -16.42,-32.64 -35.07,-10.37 -18.65,22.26 12.36,40.72 12.36,40.72 0,0 -40.44,-7.647 -52.8,8.603 11.83,18.12 52.1,16.76 52.1,16.76 0,0 -31.48,13.62 -13.57,38.73 17.93,25.1 35.29,-4.912 35.29,-4.912 0,0 -16.47,1.019 -17.87,-12.6 -1.417,-13.62 22.39,-23.14 22.39,-23.14   "  />
          <path d="m841.2, 923.1   c0,0 13.19,23.76 4.701,33.94 -8.497,10.18 -20.39,-2.115 -20.39,-2.115 0,0 -3.206,36.7 24.04,28.6 27.24,-8.103 10.84,-41.19 10.84,-41.19 0,0 29.97,29.36 48.8,22.74 -0.4896,-21.94 -35.02,-43.63 -35.02,-43.63 0,0 33.51,6.43 31.55,-24.81 -1.972,-31.22 -32.19,-15.9 -32.19,-15.9 0,0 14.35,8.49 8.442,20.73 -5.902,12.24 -30.86,6.723 -30.86,6.723   "  />
          <path d="m174.2, 936.1   c0,0 -25.47,6.847 -32.58,-4.435 -7.1,-11.29 7.457,-19.93 7.457,-19.93 0,0 -33,-13.12 -32.88,16.44 0.1246,29.56 35.09,21.99 35.09,21.99 0,0 -35.18,22.19 -34.15,42.9 20.35,5.423 49.7,-23.41 49.7,-23.41 0,0 -14.98,31.95 14.36,38.4 29.33,6.445 23.35,-28.06 23.35,-28.06 0,0 -11.7,12.14 -21.38,2.894 -9.695,-9.234 2.122,-32.81 2.122,-32.81   "  />
          <path d="m488.3, 1099 13.42,7.579 13.62,-8.009   c0.7643,-10.3 4.209,-42.71 17.37,-40.54 12.4,2.018 10.31,20.58 10.31,20.58 0,0 29.53,-20.27 7.03,-40.12 -19.87,-17.53 -36.54,14.78 -36.54,14.78 0,0 4.129,-45.87 -11.69,-59.65 -15.82,13.79 -11.69,59.65 -11.69,59.65 0,0 -16.68,-32.31 -36.54,-14.78 -22.5,19.83 7.03,40.12 7.03,40.12 0,0 -2.088,-18.57 10.31,-20.58 13.35,-2.188 16.7,31.2 17.4,40.98   "  />
          <path d="m480.7, 1144   c0,0 0.4793,16.03 -6.255,21.15 8.329,0 16.99,-8.739 16.99,-8.739 0,10.54 8.66,17.99 8.66,17.99 0,0 8.66,-7.454 8.66,-17.99 0,0 8.669,8.739 16.99,8.739 -6.738,-5.138 -6.26,-21.15 -6.26,-21.15   "  />
          <path d="m107.1, 480.9   c0,0 23.86,11.57 22.5,25 -1.369,13.43 -17.87,10.48 -17.87,10.48 0,0 17.52,31.99 35.39,9.047 17.87,-22.95 -13.75,-40.22 -13.75,-40.22 0,0 40.67,6.124 52.47,-10.58 -12.44,-17.67 -52.66,-14.79 -52.66,-14.79 0,0 31,-14.79 12.23,-39.18 -18.78,-24.41 -35.11,6.235 -35.11,6.235 0,0 16.42,-1.636 18.3,11.92 1.885,13.56 -21.57,23.99 -21.57,23.99   "  />
          <path d="m519.7, 79.44   c0,0 -0.4793,-16.02 6.26,-21.15 -8.329,0 -16.99,8.735 -16.99,8.735 0,-10.54 -8.66,-17.98 -8.66,-17.98 0,0 -8.66,7.45 -8.66,17.98 0,0 -8.669,-8.735 -16.99,-8.735 6.735,5.138 6.255,21.15 6.255,21.15   "  />
          <path d="m939.8, 520.3   c0,0 15.35,-0.3894 20.23,6.681 0.0576,-8.693 -8.251,-17.8 -8.251,-17.8 10.09,0.0728 17.29,-8.915 17.29,-8.915 0,0 -7.078,-9.089 -17.17,-9.164 0,0 8.428,-8.986 8.485,-17.67 -4.969,6.993 -20.32,6.382 -20.32,6.382   "  />
          <path d="m815.1, 865.1   c0,0 -12.61,-9.156 -12.54,-17.86 -4.967,6.977 -3.419,19.45 -3.419,19.45 -8.1,-6.283 -19.01,-3.472 -19.01,-3.472 0,0 0.5644,11.7 8.667,17.98 0,0 -11.89,2.052 -16.85,9.028 7.968,-2.579 20,7.379 20,7.379   "  />
          <path d="m227.2, 933.2   c0,0 11.48,-10.65 19.57,-8.532 -5.334,-6.677 -17.31,-8.028 -17.31,-8.028 7.753,-6.746 7.688,-18.46 7.688,-18.46 0,0 -11.03,-2.171 -18.78,4.575 0,0 0.8768,-12.54 -4.453,-19.22 0.5319,8.689 -11.56,18.56 -11.56,18.56   "  />
          <path d="m62.46, 452.6   c0,0 -15.35,0.6013 -20.32,-6.399 0.05254,8.693 8.476,17.68 8.476,17.68 -10.09,0.06637 -17.18,9.152 -17.18,9.152 0,0 7.192,8.991 17.28,8.926 0,0 -8.313,9.102 -8.262,17.79 4.88,-7.062 20.25,-6.662 20.25,-6.662   "  />
          <path d="m896.4, 141.1   c0,0 -61.39,44.05 -23.4,-10.82   l23.15,0 0.2616,10.82   z "  />
        <path d="m61.22, 77.71 0,8.628 0,416.5 0,0.05905   c-2.15,307.4 107.2,471.1 217.7,556.5 110.4,85.43 221.9,93.19 221.9,93.19   l0.5661,0.05905 0.5661,-0.05905   c0,0 107.3,-8.386 215.4,-94.09 108.2,-85.7 217.5,-249 224.1,-555.3   l0,-0.05905 0,-1.193 0,-415.6 0,-8.628 -8.265,0 -863.7,0 -8.265,0   z m36.42,43.07 810,4.301 0,379.4   c8.602,-2.09 -1.074,-2.035 -1.075,-1.974 -6.448,302.1 -107.7,433.2 -212.2,515.9 -103.6,82.06 -191.5,95.29 -193.8,97.05 -6.464,0.42 -94.48,-11.25 -200.2,-93.05 -106.6,-82.45 -199.1,-219.9 -204.4,-518.8   l-1.075,0.4786 2.15,-383.8   z "  />
        <path d="m93.81, 116.4 -0.05656,8.568 -2.152,394.7 0,0.05905 0.05656,0.1183   c3.252,272.2 104.5,422.9 205.3,504.4 100.8,81.59 201.4,94.6 201.4,94.6   l1.246,0.1181 1.189,-0.1774   c0,0 103.6,-18.99 206.2,-104.8 102.6,-85.84 204.4,-239.3 202.3,-505.2 0,-0.02031 0,-0.03894 0,-0.05905   l0,-383.8 0,-8.628 -8.265,0 -798.9,0 -8.265,0   z m16.48,17.26 782.4,0 0,375.4 0,0.05905   c1.359,166.6 -38.37,286.8 -93.08,373.5 -31.1,49.33 -67.05,87.88 -103,118 -97.57,81.64 -194.1,100.3 -197.5,101 -3.514,-0.4751 -96.56,-13.57 -192,-90.83 -97.28,-78.71 -195.7,-223.2 -198.9,-491   l0,-0.1774 2.096,-385.9   z "  />
      </g>';
    else
        $ordinary['body'] = '<g  transform="translate(0, -300)">
          <path d="m76.1, 360.1   c0,0 -10.89,-18.65 -1.485,-25.57 9.415,-6.912 20.1,3.131 20.1,3.131 0,0 6.643,-27 -21.24,-23.07 -27.88,3.934 -14.66,29.77 -14.66,29.77 0,0 -27.07,-24.1 -46.41,-20.61 -1.575,16.33 30.73,35.08 30.73,35.08 0,0 -32.75,-7.338 -33.73,16 -0.976,23.34 30.52,14.27 30.52,14.27 0,0 -13.49,-7.4 -6.453,-16.03 7.025,-8.634 31.34,-2.634 31.34,-2.634   "  />
          <path d="m106.4, 404.3   c0,0 61.39,32.87 23.4,-8.075   l-23.15,0 -0.2616,8.075   z "  />
          <path d="m492.2, 395.3   c0,0 -10.87,18.67 -23.74,17.7 -12.88,-0.9757 -10.2,-13.86 -10.2,-13.86 0,0 -30.48,13.87 -8.347,27.62 22.14,13.76 38.42,-10.98 38.42,-10.98 0,0 -5.5,31.72 10.61,40.79 16.81,-9.81 13.7,-41.11 13.7,-41.11 0,0 14.45,24.04 37.66,9.257 23.22,-14.78 -6.29,-27.3 -6.29,-27.3 0,0 1.715,12.78 -11.26,14.33 -12.97,1.56 -23.17,-16.64 -23.17,-16.64   "  />
          <path d="m938.6, 368   c0,0 23.49,-9.216 32.73,-2.17 9.239,7.053 -3.22,15.77 -3.22,15.77 0,0 34.91,4.099 28.77,-17.43 -6.152,-21.54 -38.76,-10.23 -38.76,-10.23 0,0 29.85,-22.01 24.6,-36.95 -20.99,-0.5792 -43.79,25.31 -43.79,25.31 0,0 8.116,-25.78 -21.86,-25.61 -29.99,0.1658 -17.1,24.34 -17.1,24.34 0,0 8.961,-10.79 20.32,-5.656 11.36,5.125 4.62,24.28 4.62,24.28   "  />
          <path d="m896.1, 665.1   c0,0 -23.43,-9.296 -21.61,-19.27 1.832,-9.974 18.23,-7.315 18.23,-7.315 0,0 -16.42,-24.35 -35.07,-7.736 -18.65,16.61 12.36,30.38 12.36,30.38 0,0 -40.44,-5.706 -52.8,6.419 11.83,13.52 52.1,12.51 52.1,12.51 0,0 -31.48,10.16 -13.57,28.9 17.93,18.73 35.29,-3.665 35.29,-3.665 0,0 -16.47,0.76 -17.87,-9.402 -1.417,-10.16 22.39,-17.27 22.39,-17.27   "  />
          <path d="m841.2, 986.8   c0,0 13.19,17.73 4.701,25.32 -8.497,7.597 -20.39,-1.578 -20.39,-1.578 0,0 -3.206,27.38 24.04,21.34 27.24,-6.046 10.84,-30.74 10.84,-30.74 0,0 29.97,21.91 48.8,16.97 -0.4896,-16.37 -35.02,-32.55 -35.02,-32.55 0,0 33.51,4.798 31.55,-18.51 -1.972,-23.3 -32.19,-11.87 -32.19,-11.87 0,0 14.35,6.335 8.442,15.47 -5.902,9.13 -30.86,5.016 -30.86,5.016   "  />
          <path d="m174.2, 996.5   c0,0 -25.47,5.109 -32.58,-3.31 -7.1,-8.423 7.457,-14.87 7.457,-14.87 0,0 -33,-9.793 -32.88,12.27 0.1246,22.05 35.09,16.41 35.09,16.41 0,0 -35.18,16.55 -34.15,32.01 20.35,4.047 49.7,-17.47 49.7,-17.47 0,0 -14.98,23.84 14.36,28.65 29.33,4.809 23.35,-20.94 23.35,-20.94 0,0 -11.7,9.056 -21.38,2.16 -9.695,-6.89 2.122,-24.48 2.122,-24.48   "  />
          <path d="m488.3, 1118 13.42,5.655 13.62,-5.976   c0.7643,-7.689 4.209,-31.87 17.37,-30.25 12.4,1.505 10.31,15.35 10.31,15.35 0,0 29.53,-15.13 7.03,-29.94 -19.87,-13.08 -36.54,11.03 -36.54,11.03 0,0 4.129,-34.22 -11.69,-44.51 -15.82,10.29 -11.69,44.51 -11.69,44.51 0,0 -16.68,-24.11 -36.54,-11.03 -22.5,14.8 7.03,29.94 7.03,29.94 0,0 -2.088,-13.85 10.31,-15.35 13.35,-1.633 16.7,23.28 17.4,30.58   "  />
          <path d="m480.7, 1151   c0,0 0.4793,11.96 -6.255,15.78 8.329,0 16.99,-6.52 16.99,-6.52 0,7.862 8.66,13.42 8.66,13.42 0,0 8.66,-5.562 8.66,-13.42 0,0 8.669,6.52 16.99,6.52 -6.738,-3.834 -6.26,-15.78 -6.26,-15.78   "  />
          <path d="m107.1, 656.8   c0,0 23.86,8.633 22.5,18.65 -1.369,10.02 -17.87,7.819 -17.87,7.819 0,0 17.52,23.87 35.39,6.75 17.87,-17.13 -13.75,-30.01 -13.75,-30.01 0,0 40.67,4.569 52.47,-7.892 -12.44,-13.18 -52.66,-11.04 -52.66,-11.04 0,0 31,-11.04 12.23,-29.24 -18.78,-18.21 -35.11,4.652 -35.11,4.652 0,0 16.42,-1.22 18.3,8.896 1.885,10.12 -21.57,17.9 -21.57,17.9   "  />
          <path d="m519.7, 357.3   c0,0 -0.4793,-11.96 6.26,-15.78 -8.329,0 -16.99,6.518 -16.99,6.518 0,-7.862 -8.66,-13.42 -8.66,-13.42 0,0 -8.66,5.559 -8.66,13.42 0,0 -8.669,-6.518 -16.99,-6.518 6.735,3.834 6.255,15.78 6.255,15.78   "  />
          <path d="m939.8, 686.2   c0,0 15.35,-0.2905 20.23,4.985 0.0576,-6.486 -8.251,-13.28 -8.251,-13.28 10.09,0.05432 17.29,-6.652 17.29,-6.652 0,0 -7.078,-6.782 -17.17,-6.838 0,0 8.428,-6.705 8.485,-13.19 -4.969,5.218 -20.32,4.762 -20.32,4.762   "  />
          <path d="m815.1, 943.5   c0,0 -12.61,-6.832 -12.54,-13.33 -4.967,5.206 -3.419,14.51 -3.419,14.51 -8.1,-4.688 -19.01,-2.591 -19.01,-2.591 0,0 0.5644,8.729 8.667,13.42 0,0 -11.89,1.531 -16.85,6.736 7.968,-1.924 20,5.506 20,5.506   "  />
          <path d="m227.2, 994.3   c0,0 11.48,-7.943 19.57,-6.366 -5.334,-4.982 -17.31,-5.991 -17.31,-5.991 7.753,-5.034 7.688,-13.77 7.688,-13.77 0,0 -11.03,-1.62 -18.78,3.414 0,0 0.8768,-9.359 -4.453,-14.34 0.5319,6.483 -11.56,13.85 -11.56,13.85   "  />
          <path d="m62.46, 635.7   c0,0 -15.35,0.4486 -20.32,-4.775 0.05254,6.486 8.476,13.19 8.476,13.19 -10.09,0.04952 -17.18,6.829 -17.18,6.829 0,0 7.192,6.709 17.28,6.66 0,0 -8.313,6.792 -8.262,13.28 4.88,-5.269 20.25,-4.971 20.25,-4.971   "  />
          <path d="m896.4, 403.3   c0,0 -61.39,32.87 -23.4,-8.075   l23.15,0 0.2616,8.075   z "  />
        <path d="m61.22, 356 0,6.438 0,310.8 0,0.04407   c-2.15,229.4 107.2,351.5 217.7,415.2 110.4,63.75 221.9,69.53 221.9,69.53   l0.5661,0.04407 0.5661,-0.04407   c0,0 107.3,-6.258 215.4,-70.2 108.2,-63.95 217.5,-185.8 224.1,-414.4   l0,-0.04407 0,-0.8904 0,-310.1 0,-6.438 -8.265,0 -863.7,0 -8.265,0   z m36.42,32.14 810,3.21 0,283.1   c8.602,-1.56 -1.074,-1.518 -1.075,-1.473 -6.448,225.4 -107.7,323.2 -212.2,384.9 -103.6,61.23 -191.5,71.1 -193.8,72.42 -6.464,0.3134 -94.48,-8.392 -200.2,-69.43 -106.6,-61.52 -199.1,-164.1 -204.4,-387.1   l-1.075,0.3571 2.15,-286.4   z "  />
        <path d="m93.81, 384.8 -0.05656,6.393 -2.152,294.5 0,0.04407 0.05656,0.08827   c3.252,203.1 104.5,315.5 205.3,376.4 100.8,60.88 201.4,70.59 201.4,70.59   l1.246,0.08813 1.189,-0.1323   c0,0 103.6,-14.17 206.2,-78.22 102.6,-64.05 204.4,-178.5 202.3,-376.9 0,-0.01515 0,-0.02905 0,-0.04407   l0,-286.4 0,-6.438 -8.265,0 -798.9,0 -8.265,0   z m16.48,12.88 782.4,0 0,280.1 0,0.04407   c1.359,124.3 -38.37,214 -93.08,278.7 -31.1,36.81 -67.05,65.58 -103,88.04 -97.57,60.92 -194.1,74.87 -197.5,75.36 -3.514,-0.3545 -96.56,-10.13 -192,-67.78 -97.28,-58.73 -195.7,-166.5 -198.9,-366.4   l0,-0.1323 2.096,-288   z "  />
      </g>';
}

else
{


    $margin = 24.2;
    $width = 40.4;

    if ( !is_null($layout->section) && strpos($layout->section, "quarter") !== false )
    {
        $width *= 2;
        $margin *= 2;
    }


    $path_builder = new MutableShape();

    $shape->svg_path($layout, $margin, false, $path_builder);
    $shape->svg_path($layout, $margin + $width, true, $path_builder);

    $ordinary['shape_spec'] = $path_builder;
}


$ordinary['chargesWithin'] = array ('w','300,300,400,500');

if ( existModifierWithKeyterm($node,'compony1') )
{
    $ordinary['body2'] = $shape->compony($layout, $margin, $width)->to_svg_path();
}
elseif (existModifierWithKeyterm($node,'compony2') )
{
    $body2 = $shape->compony($layout, $margin, $width);
    $shape->svg_path($layout, $margin + $width / 2, true, $body2);
    $ordinary['body2'] = $body2->to_svg_path();
}

$ordinary['feature_size'] = 20;
